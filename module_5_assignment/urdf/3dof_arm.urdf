<?xml version="1.0"?>
<robot name="three_dof_arm">

    <!-- Base Footprint -->
    <link name="base_footprint">
    </link>

    <!-- Dummy Joint -->
    <joint name="base_to_arm_base_joint" type="fixed">
        <parent link="base_footprint"/>
        <child link="arm_base_link"/>
        <origin xyz="0 0 0.0" rpy="0 0 0"/>
    </joint>

    <!-- Base Link -->
    <link name="arm_base_link">
        <visual>
            <geometry>
                <cylinder radius="0.1" length="0.1"/>
            </geometry>
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.1" length="0.1"/>
            </geometry>     
        </collision>
        <inertial>
            <mass value="1.0"/>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <inertia ixx="0.003333333333333334" ixy="0.0" ixz="0.0" iyy="0.003333333333333334" iyz="0.0" izz="0.005000000000000001"/>
        </inertial>
    </link>

    <!-- First Link -->
    <link name="shoulder_link">
        <visual>
            <geometry>
                <cylinder radius="0.05" length="0.1"/>
            </geometry>
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.05" length="0.1"/>
            </geometry> 
        </collision>
        <inertial>
            <mass value="1.0"/>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <inertia ixx="0.0014583333333333334" ixy="0.0" ixz="0.0" iyy="0.0014583333333333334" iyz="0.0" izz="0.0012500000000000002"/>
        </inertial>
    </link>

    <!-- First Joint -->
    <joint name="base_to_shoulder_joint" type="revolute">
        <parent link="arm_base_link"/>
        <child link="shoulder_link"/>
        <origin xyz="0 0 0.10" rpy="0 0 0"/>
        <axis xyz="0 0 1"/>
        <limit lower="-3.14" upper="3.14" effort="10" velocity="1"/>
    </joint>

    <!-- Second Link -->
    <link name="upper_arm_link">
        <visual>
            <geometry>
                <cylinder radius="0.05" length="0.1"/>
            </geometry>
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.05" length="0.1"/>
            </geometry>
        </collision>
        <inertial>
            <mass value="1.0"/>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <inertia ixx="0.0014583333333333334" ixy="0.0" ixz="0.0" iyy="0.0014583333333333334" iyz="0.0" izz="0.0012500000000000002"/>
        </inertial>
    </link>

    <!-- Second Joint -->
    <joint name="shoulder_to_upper_arm_joint" type="revolute">
        <parent link="shoulder_link"/>
        <child link="upper_arm_link"/>
        <origin xyz="0 0 0.10" rpy="1.57 0 0"/>
        <axis xyz="0 0 1"/>
        <limit lower="-1.57" upper="1.57" effort="10" velocity="1"/>
    </joint>

    <!-- Third Link -->
    <link name="forearm_link">
        <visual>
            <geometry>
                <cylinder radius="0.05" length="0.3"/>
            </geometry>
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.05" length="0.3"/>
            </geometry>
        </collision>
        <inertial>
            <mass value="1.0"/>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <inertia ixx="0.008125" ixy="0.0" ixz="0.0" iyy="0.008125" iyz="0.0" izz="0.0012500000000000002"/>
        </inertial>
    </link>

    <!-- Third Joint (Fixed) -->
    <joint name="upper_arm_to_forearm_joint" type="fixed">
        <parent link="upper_arm_link"/>
        <child link="forearm_link"/>
        <origin xyz="0 0.2 0" rpy="-1.57 0 0"/>
    </joint>

    <!-- Fourth Link -->
    <link name="wrist_link">
        <visual>
            <geometry>
                <cylinder radius="0.05" length="0.1"/>
            </geometry>
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.05" length="0.1"/>
            </geometry>
        </collision>
        <inertial>
            <mass value="1.0"/>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <inertia ixx="0.0014583333333333334" ixy="0.0" ixz="0.0" iyy="0.0014583333333333334" iyz="0.0" izz="0.0012500000000000002"/>
        </inertial>
    </link>

    <!-- Fourth Joint -->
    <joint name="forearm_to_wrist_joint" type="revolute">
        <parent link="forearm_link"/>
        <child link="wrist_link"/>
        <origin xyz="0 0 0.2" rpy="1.57 0 0"/>
        <axis xyz="0 0 1"/>
        <limit lower="-1.57" upper="1.57" effort="10" velocity="1"/>
    </joint>

    <!-- End Effector -->
    <link name="end_effector_link">
        <visual>
            <geometry>
                <cylinder radius="0.05" length="0.2"/>
            </geometry>
        </visual>
        <collision>
            <geometry>
                <cylinder radius="0.05" length="0.2"/>
            </geometry>
        </collision>
        <inertial>
            <mass value="1.0"/>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <inertia ixx="0.003958333333333334" ixy="0.0" ixz="0.0" iyy="0.003958333333333334" iyz="0.0" izz="0.0012500000000000002"/>
        </inertial>
    </link>
 
    <!-- End Effector Joint (Fixed) -->
    <joint name="wrist_to_end_effector_joint" type="fixed">
        <parent link="wrist_link"/>
        <child link="end_effector_link"/>
        <origin xyz="0 0.15 0" rpy="1.57 0 0"/>
    </joint>

    <ros2_control name="GazeboSystem" type="system">

        <hardware>
          <plugin>gazebo_ros2_control/GazeboSystem</plugin>
        </hardware>

        <joint name="forearm_to_wrist_joint">
          <command_interface name="position">
            <param name="min">-1.57</param>
            <param name="max">1.57</param>
          </command_interface>

          <state_interface name="position">
            <param name="initial_value">0.0</param>
          </state_interface>
        </joint>

        <joint name="base_to_shoulder_joint">
          <command_interface name="position">
            <param name="min">-1.57</param>
            <param name="max">1.57</param>
          </command_interface>

          <state_interface name="position">
            <param name="initial_value">0.0</param>
          </state_interface>
        </joint>

        <joint name="shoulder_to_upper_arm_joint">
          <command_interface name="position">
            <param name="min">-1.57</param>
            <param name="max">1.57</param>
          </command_interface>

          <state_interface name="position">
            <param name="initial_value">0.0</param>
          </state_interface>
        </joint>

    </ros2_control>

   <gazebo>
        <plugin filename="libgazebo_ros2_control.so" name="gazebo_ros2_control">
          <parameters>/home/combuster/robotisim_ws/src/robotics_software_engineer/module_5_assignment/config/position_controller.yaml</parameters>
        </plugin>
    </gazebo>

</robot>